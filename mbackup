#!/usr/bin/env bash

source "./util.sh"

header BACKUP

mkdir ./data &>/dev/null

cat <config | while read -r entry; do
	fll "$(tput cols)" -

	# Comment lines
	if [[ "${entry:0:1}" == "#" ]]; then continue; fi

	# Empty lines
	if [[ -z $entry ]]; then continue; fi

	if ! [[ -e $entry ]]; then
		echo -e "$entry doesnt exists. \n skipping ..."
		continue
	fi

	dest=$(serialize "$entry")

	if [[ -d "$entry" ]]; then
		entry="${entry}/."
	fi

	echo ">: $dest"

	cp -afv "$entry" "$dest"
done
